X = seq(40000,29000,-500)
Y = c(0.0013597695,0.0022741679,0.0037902529,0.0062952917,0.0104201648,0.0171888356,0.0282567705,0.0462888558
,0.0755534607,0.1228454204,0.1988954172,0.3204646307,0.5133222273,0.8161571605,1.2849632377,1.9961764632
,3.044463463,4.5280657074,6.5144005113,8.9886081203,11.8114512495,14.7304623387,17.4607574359)
total = 149*10^6
cost = 18000
Z = c()
for (i in (1:23))
{
  Z = c(Z,(X[i]-cost)*Y[i]/100*total)
}  
x1 = -523.0647675254
x2 = -1465.0023363551
x3 = -1136.0437558417
x4 = -1193.8135384257
x5 = -790.1830042301
x6 = -556.1267106504
x7 = -538.184812234

f <- function(x)
{
  r1 = 4.8666795772+x/100*-0.012647756
  r2 = -1.1181464385
  r3 = -2.2344406109
  p1 = exp(r1)/(exp(r1)+exp(r2)+exp(r3)+1)
  value = (1-p1)*x/100*-0.012647756
  value
}
Y2 = c()
Y2[1] = 1
for (i in (2:23))
{
  Y2 = c(Y2,(1-500/X[i]*f(X[i-1]))*Y2[i-1])
}
Z2 = c()
for (i in (1:23))
{
  Z2 = c(Z2,(X[i]-cost)*Y2[i])
}
data_temp = read.csv(file.choose()) #choose data.csv
dd = as.factor(data_temp[,1])
dd2 = as.factor(data_temp[,2])
plot(dd)
plot(dd2)
